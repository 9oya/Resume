## 프로젝트 경험

### [넷마블] Coway IoCare+ (IoT iOS 앱) 신규 개발 (2023.08 ~ 2024.11)

코웨이 스마트 기기 상태를 모니터링하고 즉시/예약 컨트롤할 수 있는 IoT 플랫폼 앱입니다.

### 프로젝트 팀 내 주요 역할

IoCare+ iOS앱은 웹뷰가 포함된 하이브리드 앱으로 개발되었습니다. 저는 프로젝트 초기 Architecture 디자인 단계에서 ReactorKit과 RxFlow를 사용한 데모 앱을 구현하여 팀내에 세미나를 진행했습니다. 이후 프로젝트 빌드/의존성 관리를 위한 tuist툴 도입 초기에 “인트로 - 인증 - 메인탭”의 기본 Coordinator구조를 구현하고 외부 라이브러리와 모듈러 프레임워크 의존성 구성하여 팀내에 공유했습니다.

프로젝트 설계 외에 “OAuth 회원인증”, 메인 탭 화면 “제품 홈”, “자동화 홈”, “자동화 상세” 파트의 개발을 맡아 프로젝트를 진행했습니다.

[🔗 ReactorKit Seminar 발표 자료](https://www.notion.so/ReactorKit-Seminar-227d642fa0f047c7b349f50f9d4c56cc?pvs=21)

[🔗 ReactorKit과 RxFlow, Factory(DI)를 사용한 GitHubSearch 데모 앱](https://github.com/9oya/GitHubSearch-reactorkit-demo)

[🔗 Tuist를 적용한 데모 앱](https://github.com/9oya/GitHubSearch-reactorkit-tuist)

### 프로젝트에 기여한 기술적 성과

- ReactorKit, RxFlow와 Tuist를 사용한 CleanArchitecture 설계후 초기 기반과 의존성 구현 구현
- Tuist에 SPM외에 CocoaPods지원이 중단되었지만, Firebase, Google Library를 이슈없이 사용하기 위해 CocoaPods사용이 필요했습니다. tuist빌드 설정과 멀티 프로젝트에 대한 Podfile빌드 의존성을 구현했습니다.
- 앱 소개 페이지와 앱 내에 요구되는 Pagination(Carousel)구현을 위해 직접 만든 오픈소스를 적용했습니다. 해당 오픈소스는 이전 프로젝트에 적용하기위해 구현했던 것이지만 이를 현재 프로젝트에 적용하기 위해 팀원들을 설득하는 과정을 경험하게 됐고, 커뮤니케이션에 중요성을 다시 한번 느낄 수 있었습니다. ([🔗 오픈소스: SSPager](https://github.com/9oya/SSPager))
- 회원인증, 관리 페이지가 코웨이 사내에 여러 웹, 앱 서비스에 통합되어 사용되는 독립적인 웹서비스였습니다. 때문에 웹뷰를 통해 JS브릿지로 동작과 데이터를 주고받으며, 웹으로 된 간편인증과 네이티브SDK를 사용하는 간편인증들을 연동하고 이슈들을 해결하였습니다. 이를 통해 하이브리드 앱에 웹뷰 동작 관리 및 OAuth인증 플로우를 경험할 수 있었습니다.
- Alamofire의 Interceptor를 사용해 OAuth토큰 발급/갱신/관리를 공통화하고, Moya의 Plugin을 이용해 API통신에 필요한 헤더정보를 쉽게 Factory pattern으로 셋팅할 수 있도록 구현했습니다.
- 공통유틸에 부분적으로 UnitTests를 최초 적용하여, Mock클래스와 Stub데이터 주입을 통한 isolate된 단위 테스트 방법을 팀내에 공유하였습니다.

**앞으로…**

- Fastlane runner를 통한 배포 pipeline개선과 matcher를 통한 certification관리 자동화 작업 예정
- CD에 사용될 GitHub Action의 개발/스테이징/운영 배포 구성과 배포 머신에 self-hosted runner를 구성하여 잦은 배포로 발생될 수 있는 Github action 사용료 절감에 기여할 예정입니다.

### 프로젝트 진행 중 가장 기억에 남는 트러블 슈팅 경험

Tuist를 이용해 CleanArchitecture를 멀티 프로젝트 모듈러하게 구현하면서 얻을 수 있는 이점중 하나로 Xcode설정을 코드레벨에서 컨트롤하면서 프로젝트 빌드 설정 및 프로젝트 모듈 의존성 등을 더 잘 이해하고 구성할수 있다는 것이 있습니다. 

Tuist는 애플 지원 Package Manager인 SPM을 지원하고 있습니다. 하지만 Firebase와 같은 레거시가 있는 라이브러리들과 같은 경우 SPM사용시 일부 기능이나 빌드가 제한된다던지 하는 이슈가 있어 CocoaPods를 사용해야 하는 케이스가 발생하기도 합니다.

IoCare+프로젝트에서 또한 GoogleSignIn과 Firebase라이브러리에서 발생한 빌드 이슈와 또 사내에서 사용하는 공통 플러그인 라이브러리가 CocoaPods으로만 배포되어 CocoaPods를 병용해야하는 상황이 발생했습니다. 저를 포함해서 iOS개발 팀원들 모두 Tuist를 처음 도입하였고 외부 레퍼런스 자료들 또한 Tuist가 Cocoapods를 지원할때의 자료와 이후 SPM만을 사용하는 자료에 중점이 되어 적용에 어려움이 많았습니다.

가장 큰 이슈는 멀티 프로젝트 환경이 되면서 앱 라이프사이클을 갖는 앱 모듈과 그에 사용되는 서브 모듈 프로젝트들의 POD_FILE_DIR_PATH, PODS_ROOT가 잘못된 이슈였습니다. Tuist를 사용하지 않았다면 Project > Target > BuildSettings에서 Path를 수정하고 Commit을 올리면 됐지만 Tuist를 사용하면 실제 Git에 SourceCodeControl에 .xcodeproj파일이 존재하지 않고 Tuist generator를 통해 각각의 개발머신에 생성되게 됩니다. 때문에 이를 Tuist 설정으로 해결해야 했고 Tuist Manifests(Project.swift)와 각 프로젝트 모듈에 POD_FILE_DIR_PATH, PODS_ROOT 상대 경로를 정상적으로 넣고 이를 환경별로 테스하고 또한 tuist generator가 항상 옳바르게 동작하기 위해 기존 생성된 파일들을 지워주는 script를 make로 만들어 추가로 pod deintegrate을 프로젝트 모듈별로 수행하여 추가된 의존성에 대한 프로젝트 설정이 올바르게 되도록해야 했습니다.

일주일이라는 시간이 소요됐지만, StackOverFlow에만 의존하지 않고 Xcode설정과 CocoaPods관련 문서를 찾아가며 Tuist툴에 대한 이해도와 PackageManager의 라이브러리 빌드와 의존성 형성에 대한 이해도를 높이게 되는 귀중한 경험이었습니다. 팀원들이 원할이 작업할 수 있게 되는데 기여를 하게 됐다는 데도 뿌듯함을 느낄 수 있었습니다.
